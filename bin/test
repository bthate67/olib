#!/usr/bin/env python3
# This file is placed in the Public Domain.

import os, sys ; sys.path.insert(0, "olib")

from hdl import Client
from obj import cfg, opts
from trm import exec
from zzz import shutil, unittest

import trc
import url

class Test(Client):

    def raw(self, txt):
        if opts("v"):
            print(txt)

class FlushTest(Test):

    def raw(self, txt):
        if opts("v"):
            sys.stdout.write(txt)
            sys.stdout.write("\n")

def main():
    cfg.opts.v = True
    cfg.wd = ".test"
    shutil.rmtree(".test", True)
    url.debug = True
    c = FlushTest()
    c.start()
    pat = "test_%s*" % "*"
    suite = unittest.loader.TestLoader().discover("test", pattern=pat)
    unittest.TextTestRunner(verbosity=3).run(suite)

exec(main)
for e in trc.exc:
    print(e)
